{"ast":null,"code":"var _jsxFileName = \"/Users/kayydv/Library/CloudStorage/OneDrive-FloridaInstituteofTechnology/Summer 2022/Intro to Software Engineering/Term-project/summer-project/src/global/authorization/UserContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useState, useContext, useEffect } from \"react\";\nimport { Role } from \"../TypeDefs\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const initializeUser = {\n  user: {\n    authenticated: false,\n    id: undefined,\n    role: Role.Unassigned\n  },\n  setUser: user => {},\n  userLogin: (email, password) => {},\n  userRegistration: (firstName, lastName, dob, email, password) => {},\n  userLogout: () => {},\n  deleteUser: userId => {},\n  editUser: (userId, firstName, lastName, dob, email, password) => {},\n  getUser: userId => {},\n  addProperty: (userId, street, city, state, zipcode, description, estimate, photos, videos) => {},\n  deleteProperty: propertyId => {},\n  editProperty: (propertyId, street, city, state, zipcode, description, estimate, photos, videos) => {}\n};\nexport const UserContext = /*#__PURE__*/createContext(initializeUser);\nexport const UserProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  const stored = window.localStorage.getItem('GilderiseUser');\n  const [user, setUser] = useState(stored == null ? {\n    authenticated: false,\n    id: undefined,\n    role: Role.Unassigned\n  } : JSON.parse(stored)); // @todo update to use JWT Token\n  // Store user data on local memory on every update of user or user.authenticated.\n\n  useEffect(() => {\n    window.localStorage.setItem('GilderiseUser', JSON.stringify(user));\n  }, [user, user.authenticated]);\n\n  const userLogin = (email, password) => {\n    console.log(\"Handling User Login\");\n    let success = false;\n    const params = {\n      'email': email,\n      'password': password\n    };\n    let requestOptions = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(params)\n    };\n\n    const login = async () => {\n      await fetch(\"/login_user\", requestOptions).then(response => {\n        response.json().then(data => {\n          console.log(data);\n\n          if (data !== false) {\n            setUser({\n              'authenticated': true,\n              'id': data.user_id,\n              'role': Role.Base\n            });\n          }\n        });\n      }).catch(e => {\n        console.log(e);\n      });\n    };\n\n    login();\n\n    if (success) {\n      navigate(\"dashboard\");\n    } else {// warn user of unsuccessful registration attempt\n    }\n  };\n\n  const userRegistration = (firstName, lastName, dob, email, password) => {\n    console.log(\"Handling User Registration\");\n    let success = false;\n    const params = {\n      'first_name': firstName,\n      'last_name': lastName,\n      'email': email,\n      'password': password\n    };\n    let requestOptions = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(params)\n    };\n\n    const register = async () => {\n      await fetch(\"/add_user\", requestOptions).then(response => {\n        response.json().then(data => {\n          console.log(data);\n\n          if (data !== false) {\n            success = true;\n            setUser({\n              'authenticated': true,\n              'id': data.user_id,\n              'role': Role.Base\n            });\n          }\n        });\n      }).catch(e => {\n        console.log(e);\n      });\n    };\n\n    register();\n\n    if (success) {\n      navigate(\"dashboard\");\n    } else {// warn user of unsuccessful registration attempt\n    }\n  };\n\n  const userLogout = () => {\n    // Remove user info.\n    setUser({\n      authenticated: false,\n      id: undefined,\n      role: Role.Unassigned\n    });\n    navigate(\"/\");\n  };\n\n  const test = () => {\n    const test = async () => await fetch(\"/hello\").then(response => {\n      response.json().then(data => {\n        console.log(data.string);\n      });\n    }).catch(e => {\n      console.log(e);\n    });\n\n    test();\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      user,\n      userLogin,\n      userRegistration,\n      userLogout,\n      test\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 3\n  }, this);\n};\n\n_s(UserProvider, \"2z0BvlugMOLA5XrCW0z9/Pv3Ay0=\", false, function () {\n  return [useNavigate];\n});\n\n_c = UserProvider;\nexport const useUser = () => {\n  _s2();\n\n  return useContext(UserContext);\n};\n\n_s2(useUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport default UserContext;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["createContext","useState","useContext","useEffect","Role","useNavigate","initializeUser","user","authenticated","id","undefined","role","Unassigned","setUser","userLogin","email","password","userRegistration","firstName","lastName","dob","userLogout","deleteUser","userId","editUser","getUser","addProperty","street","city","state","zipcode","description","estimate","photos","videos","deleteProperty","propertyId","editProperty","UserContext","UserProvider","children","navigate","stored","window","localStorage","getItem","JSON","parse","setItem","stringify","console","log","success","params","requestOptions","method","headers","body","login","fetch","then","response","json","data","user_id","Base","catch","e","register","test","string","useUser"],"sources":["/Users/kayydv/Library/CloudStorage/OneDrive-FloridaInstituteofTechnology/Summer 2022/Intro to Software Engineering/Term-project/summer-project/src/global/authorization/UserContext.tsx"],"sourcesContent":["import { createContext, useState, useContext, useEffect } from \"react\" ;\nimport { Role, User } from \"../TypeDefs\" ;\nimport { useNavigate } from \"react-router-dom\" ;\nimport { json } from \"stream/consumers\" ;\n\n\nexport const initializeUser:\n\t{\n\t\tuser: User, setUser: any, userLogin: any, userRegistration: any, userLogout: any,\n\t\tdeleteUser: any, editUser: any, getUser: any, addProperty: any, deleteProperty: any,\n\t\teditProperty:any,\n\t} =\n{\n\tuser: {\n\t\tauthenticated: false,\n\t\tid: undefined,\n\t\trole: Role.Unassigned\n\t},\n\tsetUser: (user: User) => { },\n\tuserLogin: (email: string, password: string) => { },\n\tuserRegistration: (firstName: string, lastName: string, dob: string, email: string, password: string) => { },\n\tuserLogout: () => { },\n\tdeleteUser: (userId: number) => { },\n\teditUser: (userId: number, firstName: string, lastName: string, dob: string, email: string, password: string) => { },\n\tgetUser: (userId: number) => { },\n\taddProperty: (userId: number, street: string, city: string, state: string, zipcode: string, description: string, estimate: string, photos: any, videos: any) => { },\n\tdeleteProperty: (propertyId: number) => { },\n\teditProperty: (propertyId: number, street: string, city: string, state: string, zipcode: string, description: string, estimate: string, photos: any, videos: any) => { },\n\n\n\t\n}\n\nexport const UserContext = createContext<any>(initializeUser) ;\n\nexport const UserProvider = ({ children }) => {\n\n\tconst navigate = useNavigate() ;\n\tconst stored = window.localStorage.getItem('GilderiseUser') ;\n\tconst [user, setUser] = useState<User>( stored == null ?\n\t\t{\n\t\t\tauthenticated: false,\n\t\t\tid: undefined,\n\t\t\trole: Role.Unassigned\n\t\t} :\n\t\tJSON.parse(stored)) ;\n\n\t// @todo update to use JWT Token\n\t// Store user data on local memory on every update of user or user.authenticated.\n\tuseEffect(() => {\n\t\twindow.localStorage.setItem('GilderiseUser', JSON.stringify(user)) ;\n\n\t}, [user, user.authenticated])\n\n\tconst userLogin = (email: string, password: string) => {\n\n\t\tconsole.log(\"Handling User Login\") ;\n\t\tlet success = false ;\n\n\t\tconst params = {\n\t\t\t'email': email,\n\t\t\t'password': password,\n\t\t}\n\n\t\tlet requestOptions = {\n\t\t\tmethod: \"POST\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t},\n\t\t\tbody: JSON.stringify(params)\n\t\t}\n\t\n\t\tconst login = async () => {\n\t\t\tawait fetch(\"/login_user\", requestOptions).then(response => {\n\t\t\t\tresponse.json().then(data => {\n\t\t\t\t\tconsole.log(data)\n\t\t\t\t\tif (data !== false){\n\t\t\t\t\t\tsetUser({\n\t\t\t\t\t\t\t'authenticated': true,\n\t\t\t\t\t\t\t'id': data.user_id,\n\t\t\t\t\t\t\t'role': Role.Base\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}).catch(e => {\n\t\t\t\tconsole.log(e)\n\t\t\t})\n\t\t}\n\n\t\tlogin() ;\n\t\t\n\t\tif (success) {\n\t\t\tnavigate(\"dashboard\") ;\n\t\t} else { \n\t\t\t// warn user of unsuccessful registration attempt\n\t\t}\n\t\t\n\t}\n\n\tconst userRegistration = (firstName: string, lastName: string, dob: string, email: string, password: string) => {\n\t\tconsole.log(\"Handling User Registration\");\n\t\t\n\t\tlet success = false ;\n\n\t\tconst params = {\n\t\t\t'first_name': firstName,\n\t\t\t'last_name': lastName,\n\t\t\t'email': email,\n\t\t\t'password': password,\n\t\t}\n\n\t\tlet requestOptions = {\n\t\t\tmethod: \"POST\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t},\n\t\t\tbody: JSON.stringify(params)\n\t\t}\n\t\n\t\tconst register = async () => {\n\t\t\tawait fetch(\"/add_user\", requestOptions).then(response => {\n\t\t\t\tresponse.json().then(data => {\n\t\t\t\t\tconsole.log(data) ;\n\t\t\t\t\tif (data !== false) {\n\t\t\t\t\t\tsuccess = true ;\n\t\t\t\t\t\tsetUser({\n\t\t\t\t\t\t\t'authenticated': true,\n\t\t\t\t\t\t\t'id': data.user_id,\n\t\t\t\t\t\t\t'role': Role.Base\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}).catch(e => {\n\t\t\t\tconsole.log(e)\n\t\t\t})\n\t\t}\n\n\t\tregister();\n\t\tif (success) {\n\t\t\tnavigate(\"dashboard\") ;\n\t\t} else { \n\t\t\t// warn user of unsuccessful registration attempt\n\t\t}\n\t\t\n\t}\n\n\tconst userLogout = () => {\n\t\t// Remove user info.\n\t\tsetUser({\n\t\t\tauthenticated: false,\n\t\t\tid: undefined,\n\t\t\trole: Role.Unassigned,\n\t\t}) ;\n\t\tnavigate(\"/\") ;\n\t}\n\t\n\tconst test = () => {\n\n\t\tconst test = async () => await fetch(\"/hello\").then(response => {\n\t\t\tresponse.json().then(data => {\n\t\t\t\tconsole.log(data.string)\n\t\t\t})\n\t\t}).catch(e => {\n\t\t\tconsole.log(e)\n\t\t})\n\n\t\ttest() ;\n\t}\n\n\t\n\n  \n\treturn (\n\t\t<UserContext.Provider value={{ user, userLogin, userRegistration, userLogout,test }}>\n\t\t\t{children}\n\t\t</UserContext.Provider>\n\t)\n}\n\nexport const useUser = () => useContext(UserContext) ;\n\nexport default UserContext ;"],"mappings":"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"},"metadata":{},"sourceType":"module"}